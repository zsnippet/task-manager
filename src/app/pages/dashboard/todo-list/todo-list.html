<div class="p-6 max-w-6xl mx-auto space-y-6">
  <!-- Filter + Search + Sort Bar -->
  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
    <!-- Filters + Search -->
    <div class="flex flex-wrap items-center gap-4">
      <!-- View Filter Buttons -->
      <div class="inline-flex rounded-full bg-gray-50 border border-gray-200 shadow-sm overflow-hidden">
        <button
          class="px-4 py-2 font-medium transition-all duration-200 hover:bg-gray-100 focus:outline-none"
          [class.bg-gradient-to-r]="view() === 'all'"
          [class.from-blue-500]="view() === 'all'"
          [class.to-indigo-500]="view() === 'all'"
          [class.text-white]="view() === 'all'"
          [class.text-gray-700]="view() !== 'all'"
          (click)="setView('all')"
        >All</button>
        <button
          class="px-4 py-2 border-l font-medium transition-all duration-200 hover:bg-gray-100 focus:outline-none"
          [class.bg-gradient-to-r]="view() === 'completed'"
          [class.from-green-200]="view() === 'completed'"
          [class.to-green-300]="view() === 'completed'"
          [class.text-gray-800]="view() === 'completed'"
          [class.text-gray-700]="view() !== 'completed'"
          (click)="setView('completed')"
        >
          Completed
        </button>

        <button
          class="px-4 py-2 border-l font-medium transition-all duration-200 hover:bg-gray-100 focus:outline-none"
          [class.bg-gradient-to-r]="view() === 'inProgress'"
          [class.from-yellow-200]="view() === 'inProgress'"
          [class.to-yellow-300]="view() === 'inProgress'"
          [class.text-gray-800]="view() === 'inProgress'"
          [class.text-gray-700]="view() !== 'inProgress'"
          (click)="setView('inProgress')"
        >
          In Progress
        </button>

        <button
          class="px-4 py-2 border-l rounded-r-full font-medium transition-all duration-200 hover:bg-gray-100 focus:outline-none"
          [class.bg-gradient-to-r]="view() === 'pending'"
          [class.from-gray-300]="view() === 'pending'"
          [class.to-gray-400]="view() === 'pending'"
          [class.text-white]="view() === 'pending'"
          [class.text-gray-700]="view() !== 'pending'"
          (click)="setView('pending')"
        >Pending</button>
      </div>

      <!-- Search Input -->
      <div class="relative">
        <input
          type="text"
          class="border border-gray-300 rounded-lg px-4 py-2 pl-10 w-full sm:w-64 focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-blue-300 shadow-sm transition"
          placeholder="Search tasks..."
          [value]="query()"
          (input)="query.set($any($event.target).value)"
        />
        <svg class="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1110.5 3a7.5 7.5 0 016.15 13.65z" />
        </svg>
      </div>
    </div>

    <!-- Sort Buttons -->
    <div class="flex gap-2">
      <button
        class="px-3 py-1 border border-gray-300 rounded text-xs flex items-center gap-1 hover:bg-gray-100 transition cursor-pointer"
        [class.bg-gray-100]="sortOrder() === 'asc'"
        (click)="sortOrder.set('asc')"
      >
        ↑ Asc
      </button>
      <button
        class="px-3 py-1 border border-gray-300 rounded text-xs flex items-center gap-1 hover:bg-gray-100 transition cursor-pointer"
        [class.bg-gray-100]="sortOrder() === 'desc'"
        (click)="sortOrder.set('desc')"
      >
        ↓ Desc
      </button>
    </div>
  </div>

  <!-- Task List -->
  <div class="space-y-4">
    <div
      *ngFor="let t of sortedTodos(); trackBy: trackById"
      class="bg-white rounded-xl shadow hover:shadow-md transition p-4 flex flex-col md:flex-row md:items-center gap-4 md:gap-6"
    >
      <!-- Status Dot -->
      <div
        class="h-4 w-4 rounded-full border flex-shrink-0 mt-1 md:mt-0"
        [ngClass]="{
          'bg-green-300 border-green-400': t.status === 'completed',
          'bg-yellow-300 border-yellow-400': t.status === 'inProgress',
          'bg-gray-200 border-gray-400': t.status === 'pending'
        }"
      ></div>

      <!-- Task Info -->
      <div class="flex-1 flex flex-col md:flex-row md:justify-between md:items-center gap-2 md:gap-6">
        <div>
          <div
            class="font-semibold text-gray-900"
            [class.line-through]="t.status === 'completed'"
            [class.text-gray-400]="t.status === 'completed'"
          >
            {{ t.title }}
          </div>
          <div class="text-xs text-gray-500 mt-1 md:mt-0">
            #{{ t.id }} • Due: {{ t.dueDate | date:'mediumDate' }}
          </div>
        </div>

        <!-- Status Badge -->
        <span
          class="text-xs px-2 py-1 rounded-full font-medium flex-shrink-0"
          [ngClass]="{
            'bg-green-100 text-green-700': t.status === 'completed',
            'bg-yellow-100 text-yellow-700': t.status === 'inProgress',
            'bg-gray-100 text-gray-700': t.status === 'pending'
          }"
        >
          {{ t.status | titlecase }}
        </span>
      </div>

      <!-- Actions -->
      <div class="flex gap-2 mt-2 md:mt-0">
        <select
          class="px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-200 transition disabled:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed"
          [value]="t.status"
          (change)="changeStatus(t, $any($event.target).value)"
          [disabled]="t.status === 'completed'"
        >
          <option value="pending">Pending</option>
          <option value="inProgress">In Progress</option>
          <option value="completed">Completed</option>
        </select>

       <button
          class="px-3 py-1 border rounded text-xs 
                bg-blue-100 text-blue-700 
                hover:bg-blue-200 
                transition 
                cursor-pointer 
                disabled:bg-gray-200 
                disabled:text-gray-400 
                disabled:border-gray-300 
                disabled:cursor-not-allowed"
          (click)="editTask(t.id)"
          [disabled]="t.status === 'completed'"
        >
          Edit
        </button>

      </div>
    </div>

    <div *ngIf="sortedTodos().length === 0" class="p-6 text-center text-gray-500 text-sm">
      No tasks found matching the filters.
    </div>
  </div>
</div>
